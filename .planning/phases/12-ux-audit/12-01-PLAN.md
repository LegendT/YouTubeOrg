---
phase: 12-ux-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/globals.css
  - src/app/layout.tsx
  - src/components/ui/empty-state.tsx
  - src/components/ui/spinner.tsx
  - src/components/theme-toggle.tsx
  - .planning/phases/12-ux-audit/12-UX-AUDIT.md
autonomous: true

must_haves:
  truths:
    - "Dark mode toggle works — clicking theme toggle switches between light and dark themes"
    - "System theme preference is detected — first visit respects OS dark/light setting"
    - "No flash of wrong theme on page load — suppressHydrationWarning prevents FOUC"
    - "Semantic colour tokens for success/warning/info are available in both light and dark modes"
    - "Phosphor Icons library is installed and available for import"
    - "Reusable EmptyState and Spinner components exist for use across all pages"
    - "Formal UX audit document exists cataloguing every issue per page"
  artifacts:
    - path: "src/app/globals.css"
      provides: "Semantic colour tokens (success, warning, info) for light and dark modes"
      contains: "--success"
    - path: "src/app/layout.tsx"
      provides: "ThemeProvider wrapping entire app with system preference detection"
      contains: "ThemeProvider"
    - path: "src/components/theme-toggle.tsx"
      provides: "Client-side theme toggle component using next-themes"
      contains: "useTheme"
    - path: "src/components/ui/empty-state.tsx"
      provides: "Reusable empty state component with icon, title, description, and optional CTA"
      exports: ["EmptyState"]
    - path: "src/components/ui/spinner.tsx"
      provides: "Reusable spinner component replacing inconsistent Loader2 usage"
      exports: ["Spinner"]
    - path: ".planning/phases/12-ux-audit/12-UX-AUDIT.md"
      provides: "Comprehensive UX audit document with issues per page"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/theme-toggle.tsx"
      via: "ThemeProvider wrapping app enables useTheme in ThemeToggle"
      pattern: "ThemeProvider"
---

<objective>
Set up the foundation for the entire Phase 12 UX audit: dark mode infrastructure, new icon library, shared UI components, and the formal audit document.

Purpose: Every subsequent plan depends on these foundations — ThemeProvider enables dark mode, Phosphor enables icon migration, shared components (EmptyState, Spinner) provide consistent patterns, and the audit document tracks all issues.

Output: Working dark mode toggle, Phosphor installed, reusable UI primitives, comprehensive UX audit document.
</objective>

<execution_context>
@/Users/anthonygeorge/.claude/get-shit-done/workflows/execute-plan.md
@/Users/anthonygeorge/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-ux-audit/12-RESEARCH.md
@.planning/phases/12-ux-audit/12-CONTEXT.md
@src/app/globals.css
@src/app/layout.tsx
@src/components/navigation.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Phosphor Icons, wire up ThemeProvider, add semantic colour tokens</name>
  <files>
    src/app/globals.css
    src/app/layout.tsx
    src/components/theme-toggle.tsx
  </files>
  <action>
    1. Run `npm install @phosphor-icons/react`.

    2. In `src/app/globals.css`:
       - Add new semantic tokens to `:root` block:
         ```
         --success: oklch(0.55 0.15 145);
         --success-foreground: oklch(0.985 0 0);
         --warning: oklch(0.75 0.15 85);
         --warning-foreground: oklch(0.25 0 0);
         --info: oklch(0.6 0.15 250);
         --info-foreground: oklch(0.985 0 0);
         ```
       - Add corresponding dark mode tokens to `.dark` block:
         ```
         --success: oklch(0.65 0.15 145);
         --success-foreground: oklch(0.15 0 0);
         --warning: oklch(0.70 0.15 85);
         --warning-foreground: oklch(0.15 0 0);
         --info: oklch(0.55 0.15 250);
         --info-foreground: oklch(0.985 0 0);
         ```
       - Add to `@theme inline` block:
         ```
         --color-success: var(--success);
         --color-success-foreground: var(--success-foreground);
         --color-warning: var(--warning);
         --color-warning-foreground: var(--warning-foreground);
         --color-info: var(--info);
         --color-info-foreground: var(--info-foreground);
         ```

    3. In `src/app/layout.tsx`:
       - Import `ThemeProvider` from `next-themes`
       - Add `suppressHydrationWarning` to `<html>` tag
       - Wrap `{children}` and all providers with `<ThemeProvider attribute="class" defaultTheme="system" enableSystem>`
       - Import and add `IconContext` from `@phosphor-icons/react` wrapping children with `value={{ size: 20, weight: "regular" }}`
       - Keep existing `<Navigation />` and `<Toaster />` inside the providers

    4. Create `src/components/theme-toggle.tsx`:
       - 'use client' component
       - Import `useTheme` from `next-themes`, `Sun` and `Moon` from `@phosphor-icons/react`, and `Button` from `@/components/ui/button`
       - Render a `Button variant="ghost" size="icon"` that toggles between light/dark
       - Show Sun icon in light mode, Moon in dark mode using CSS rotation/scale transitions as per RESEARCH.md pattern
       - Add `aria-label="Toggle theme"` for accessibility
       - Handle hydration: use `mounted` state pattern (useState + useEffect) to avoid SSR mismatch — render null or placeholder until mounted
  </action>
  <verify>
    Run `npm run build` to verify no TypeScript errors. Verify `@phosphor-icons/react` is in package.json dependencies. Verify `next-themes` ThemeProvider is in layout.tsx.
  </verify>
  <done>
    ThemeProvider wraps the app with attribute="class" and defaultTheme="system". suppressHydrationWarning on html tag. IconContext.Provider sets app-wide Phosphor defaults. ThemeToggle component renders Sun/Moon toggle. globals.css has success/warning/info semantic tokens in both light and dark. @phosphor-icons/react installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create shared EmptyState and Spinner components</name>
  <files>
    src/components/ui/empty-state.tsx
    src/components/ui/spinner.tsx
  </files>
  <action>
    1. Create `src/components/ui/spinner.tsx`:
       - Import `CircleNotch` from `@phosphor-icons/react` and `cn` from `@/lib/utils`
       - Export `Spinner` component accepting `className?: string` and optional `size?: number` (default 20)
       - Render `<CircleNotch weight="bold" className={cn("animate-spin text-muted-foreground", className)} size={size} />`
       - This replaces all inconsistent `Loader2` spinner usage across the app

    2. Create `src/components/ui/empty-state.tsx`:
       - Import `Button` from `@/components/ui/button`, `Link` from `next/link`, `cn` from `@/lib/utils`
       - Define `EmptyStateProps` interface:
         ```
         icon: React.ComponentType<{ size?: number; weight?: string; className?: string }>
         title: string
         description: string
         action?: { label: string; href?: string; onClick?: () => void }
         className?: string
         ```
       - Export `EmptyState` component that renders:
         - Centred flex column with `py-16 text-center`
         - Icon at size 48, weight "light", `text-muted-foreground/50 mb-4`
         - Title as `h3` with `text-lg font-medium text-foreground mb-1`
         - Description as `p` with `text-sm text-muted-foreground max-w-sm mb-6`
         - Optional CTA: if `action.href`, wrap Button in Link; if `action.onClick`, Button with onClick
       - Style follows RESEARCH.md Pattern 6 exactly
  </action>
  <verify>
    Run `npm run build` to verify components compile. Check that EmptyState and Spinner export correctly.
  </verify>
  <done>
    EmptyState component renders icon (48px light), title, description, and optional CTA button/link. Spinner component renders animated CircleNotch replacing Loader2 pattern. Both use semantic colour tokens.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create formal UX audit document</name>
  <files>
    .planning/phases/12-ux-audit/12-UX-AUDIT.md
  </files>
  <action>
    Create a comprehensive UX audit document at `.planning/phases/12-ux-audit/12-UX-AUDIT.md`. This document catalogues every UX issue found per page, using information from RESEARCH.md's codebase analysis plus systematic review.

    Structure the document with:
    - Header with audit date, auditor, reference app (Linear)
    - Global issues section (dark mode not wired, hardcoded colours count, inconsistent containers, icon library, accessibility gaps)
    - Per-page sections (Landing, Dashboard, Analysis, Videos, ML Categorisation, ML Review, Safety, Sync, Navigation)
    - Each issue has: severity (critical/major/minor), category (colour/layout/accessibility/interaction/empty-state/loading/typography), description, current state, target state, status (pending/in-progress/fixed)
    - Summary statistics at bottom

    Use the RESEARCH.md findings directly:
    - 157 hardcoded gray colours across 20 files
    - 37 bg-white/bg-black across 17 files
    - 138 hardcoded blue/red/green/yellow across 28 files
    - Only 16 aria-*/role= attributes across 8 files
    - Inconsistent containers (max-w-6xl, max-w-4xl, max-w-2xl, container mx-auto)
    - Inconsistent heading sizes (text-3xl vs text-2xl)
    - No ThemeProvider wired
    - Empty states are plain text
    - Inconsistent loading spinners
    - Navigation uses raw <a> for sign out
    - Raw <button> and <input> elements instead of shadcn components

    Mark global foundation issues as "in-progress" (being addressed by Plan 01). All others as "pending".
  </action>
  <verify>
    Verify the file exists and contains per-page issue listings with severity ratings.
  </verify>
  <done>
    UX audit document exists with every identified issue catalogued per page, severity-rated, and status-tracked. Foundation issues marked in-progress, all others pending.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with zero errors
2. `@phosphor-icons/react` present in `package.json` dependencies
3. `ThemeProvider` wraps app in `layout.tsx` with `attribute="class"` and `defaultTheme="system"`
4. `suppressHydrationWarning` on `<html>` tag
5. `IconContext.Provider` sets app-wide icon defaults
6. `globals.css` has `--success`, `--warning`, `--info` tokens in both `:root` and `.dark`
7. `EmptyState` component exports from `src/components/ui/empty-state.tsx`
8. `Spinner` component exports from `src/components/ui/spinner.tsx`
9. `ThemeToggle` component exports from `src/components/theme-toggle.tsx`
10. `12-UX-AUDIT.md` exists with per-page issue catalogue
</verification>

<success_criteria>
Dark mode infrastructure is fully wired (ThemeProvider + semantic tokens + toggle component). Phosphor Icons installed with app-wide defaults. Reusable EmptyState and Spinner components ready for adoption across all pages. Formal audit document tracks every identified UX issue.
</success_criteria>

<output>
After completion, create `.planning/phases/12-ux-audit/12-01-SUMMARY.md`
</output>
