---
phase: 06-review-and-approval-interface
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - src/components/ml-review/review-grid.tsx
  - src/components/ml-review/review-card.tsx
  - src/components/ml-review/review-progress.tsx
autonomous: true

must_haves:
  truths:
    - "User sees videos in virtualized grid with thumbnails and confidence badges"
    - "User sees progress stats showing reviewed count and confidence breakdown"
    - "User can identify low-confidence videos at a glance via visual indicators"
  artifacts:
    - path: "src/components/ml-review/review-grid.tsx"
      provides: "Virtualized grid for review interface"
      min_lines: 80
    - path: "src/components/ml-review/review-card.tsx"
      provides: "Video card with confidence badge and review state"
      min_lines: 60
    - path: "src/components/ml-review/review-progress.tsx"
      provides: "Progress tracker with confidence filtering"
      min_lines: 50
  key_links:
    - from: "ReviewGrid"
      to: "@tanstack/react-virtual"
      via: "useVirtualizer hook"
      pattern: "useVirtualizer.*count.*estimateSize"
    - from: "ReviewCard"
      to: "VideoCard patterns"
      via: "extends Phase 4 patterns"
      pattern: "thumbnail.*title.*channelTitle"
---

<objective>
Create virtualized grid component, review card with confidence badges, and progress tracking display for the ML review interface.

Purpose: Provides efficient rendering of 4,000 videos with visual confidence indicators and progress statistics to help user prioritize review workflow.

Output: 3 new React components for grid display, card layout, and progress tracking.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-review-and-approval-interface/06-CONTEXT.md
@.planning/phases/06-review-and-approval-interface/06-RESEARCH.md
@src/components/videos/video-grid.tsx
@src/components/videos/video-card.tsx
@src/types/ml.ts
</context>

<tasks>

<task type="auto">
  <name>Create virtualized review grid component</name>
  <files>
    src/components/ml-review/review-grid.tsx
  </files>
  <action>
Create ReviewGrid component extending Phase 4 VideoGrid patterns:

**Props:** results: ReviewResult[], focusedIndex: number, onCardClick: (videoId: number) => void, onFocusChange: (index: number) => void

**Implementation:**
- Import useVirtualizer from @tanstack/react-virtual, useRef from react
- Use parentRef for scroll container
- Fixed 3 columns (matches RESEARCH.md review interface recommendation)
- ROW_HEIGHT = 380 (per Phase 4 decision)
- estimateSize: () => 380, overscan: 3 (Phase 4 pattern)
- Row-based virtualization: rowVirtualizer calculates Math.ceil(results.length / 3) rows
- Grid layout: grid grid-cols-3 gap-6 px-12 (Phase 4 pattern)
- Map over rowVirtualizer.getVirtualItems(), slice results array per row
- Render ReviewCard for each result in row
- Pass focusedIndex to ReviewCard for visual focus ring (Phase 4 pattern)
- Pass onCardClick to ReviewCard for Enter key handling

**Styling:** Use Tailwind classes matching Phase 4 video-grid.tsx (flex-1 overflow-auto, relative positioning for virtual items, translateY for row positioning)

Pattern: Copy Phase 4 src/components/videos/video-grid.tsx structure, replace VideoCard with ReviewCard, pass focusedIndex for keyboard nav.
  </action>
  <verify>
Check component exports and TypeScript compilation:
```bash
grep -n "export function ReviewGrid" src/components/ml-review/review-grid.tsx
grep -n "useVirtualizer" src/components/ml-review/review-grid.tsx
npm run build
```
  </verify>
  <done>
- ReviewGrid component created with @tanstack/react-virtual integration
- Fixed 3-column grid with ROW_HEIGHT 380px
- Supports focusedIndex prop for keyboard navigation
- Renders ReviewCard components in virtualized rows
- TypeScript compilation succeeds
  </done>
</task>

<task type="auto">
  <name>Create review card with confidence badges</name>
  <files>
    src/components/ml-review/review-card.tsx
  </files>
  <action>
Create ReviewCard component extending Phase 4 VideoCard patterns:

**Props:** result: ReviewResult, isFocused: boolean, onClick: (videoId: number) => void

**Layout (match Phase 4 VideoCard structure):**
- Outer div: group relative flex flex-col gap-1.5 p-3 rounded-lg border hover:shadow-md transition-shadow cursor-pointer
- Add focus ring: isFocused ? "ring-2 ring-blue-500" : ""
- onClick handler calls onClick(result.videoId)

**Card content:**
1. **Thumbnail:** img with result.thumbnailUrl, aspect-video object-cover rounded (Phase 4 pattern)
2. **Confidence badge overlay:** absolute top-1 right-1, color-coded based on confidence:
   - HIGH: bg-green-600 text-white
   - MEDIUM: bg-amber-500 text-white
   - LOW: bg-red-600 text-white
   - Text: result.confidence, text-xs font-semibold px-2 py-1 rounded
3. **Review state indicator (if accepted/rejected):**
   - If result.acceptedAt: absolute top-1 left-1, CheckCircle icon from lucide-react, text-green-600 bg-white rounded-full
   - If result.rejectedAt: absolute top-1 left-1, XCircle icon from lucide-react, text-red-600 bg-white rounded-full
4. **Title:** text-sm font-medium line-clamp-2 (Phase 4 pattern)
5. **Suggested category:** text-xs text-muted-foreground, "Suggested: {result.suggestedCategoryName}"
6. **Channel & similarity:** text-xs text-muted-foreground, "{result.channelTitle} â€¢ {result.similarityScore}% match"

**Imports:** CheckCircle, XCircle from lucide-react, ReviewResult type from @/types/ml

Pattern: Extend Phase 4 src/components/videos/video-card.tsx layout, add confidence badge overlay, add review state icons.
  </action>
  <verify>
Check component exports:
```bash
grep -n "export function ReviewCard" src/components/ml-review/review-card.tsx
grep -n "lucide-react" src/components/ml-review/review-card.tsx
npm run build
```
  </verify>
  <done>
- ReviewCard component created with thumbnail, title, channel, confidence badge
- Color-coded confidence badges (green=HIGH, amber=MEDIUM, red=LOW)
- Review state icons (CheckCircle for accepted, XCircle for rejected)
- Supports isFocused prop for focus ring styling
- Layout matches Phase 4 VideoCard patterns
- TypeScript compilation succeeds
  </done>
</task>

<task type="auto">
  <name>Create progress tracking component</name>
  <files>
    src/components/ml-review/review-progress.tsx
  </files>
  <action>
Create ReviewProgress component for stats display and confidence filtering:

**Props:** stats: ReviewStats, currentFilter: 'all' | 'HIGH' | 'MEDIUM' | 'LOW', onFilterChange: (filter: typeof currentFilter) => void

**Layout:**
- Outer container: flex items-center justify-between gap-4 p-4 bg-card border-b
- Left side: Progress text
  - "Reviewed {stats.reviewed} / {stats.total} videos"
  - Calculate percentage: Math.round((stats.reviewed / stats.total) * 100)
  - Display: text-sm with percentage in text-muted-foreground
- Right side: Filter buttons
  - Button for "All": stats.total count, active state when currentFilter === 'all'
  - Button for "High": stats.highConfidence count, active state when currentFilter === 'HIGH'
  - Button for "Medium": stats.mediumConfidence count, active state when currentFilter === 'MEDIUM'
  - Button for "Low": stats.lowConfidence count, active state when currentFilter === 'LOW'
  - Active button styling: bg-primary text-primary-foreground
  - Inactive button styling: bg-secondary text-secondary-foreground hover:bg-secondary/80
  - Button class: text-xs px-3 py-1.5 rounded transition-colors

**onClick:** Each button calls onFilterChange with its filter value ('all', 'HIGH', 'MEDIUM', 'LOW')

**Imports:** ReviewStats type from @/types/ml

Pattern: Simple stats display with filter toggles, follows Phase 4 toolbar patterns (video-toolbar.tsx).
  </action>
  <verify>
Check component exports:
```bash
grep -n "export function ReviewProgress" src/components/ml-review/review-progress.tsx
grep -n "ReviewStats" src/components/ml-review/review-progress.tsx
npm run build
```
  </verify>
  <done>
- ReviewProgress component displays reviewed count and total
- Shows confidence breakdown with counts (High/Medium/Low)
- Filter buttons toggle currentFilter state
- Active filter has distinct visual styling
- TypeScript compilation succeeds
  </done>
</task>

</tasks>

<verification>
1. ReviewGrid component uses @tanstack/react-virtual with 3-column layout
2. ReviewCard displays thumbnail, confidence badge, review state icons, and metadata
3. ReviewProgress shows stats and filter buttons
4. All components follow Phase 4 patterns (VideoGrid/VideoCard structure)
5. TypeScript compilation succeeds (npm run build)
6. Components accept proper props with TypeScript types
</verification>

<success_criteria>
- ReviewGrid renders 4,000 videos efficiently via virtualization
- ReviewCard shows color-coded confidence badges (green/amber/red)
- Review state visible via CheckCircle/XCircle icons
- ReviewProgress displays reviewed count and confidence breakdown
- Filter buttons toggle between all/HIGH/MEDIUM/LOW views
- All components compile and follow established UI patterns
</success_criteria>

<output>
After completion, create `.planning/phases/06-review-and-approval-interface/06-02-SUMMARY.md`
</output>
