---
phase: 06-review-and-approval-interface
plan: 04
type: execute
wave: 3
depends_on: ["06-02", "06-03"]
files_modified:
  - src/app/ml-review/page.tsx
  - src/components/ml-review/review-page.tsx
autonomous: true

must_haves:
  truths:
    - "User can navigate grid with Tab/Shift+Tab to focus cards"
    - "User can press Enter to open modal for focused card"
    - "User sees review grid with modal integration"
  artifacts:
    - path: "src/app/ml-review/page.tsx"
      provides: "Server Component for data loading"
      min_lines: 30
    - path: "src/components/ml-review/review-page.tsx"
      provides: "Basic client orchestrator for grid + modal integration"
      min_lines: 80
  key_links:
    - from: "ReviewPage Tab handler"
      to: "gridFocusIndex state"
      via: "useHotkeys with enabled: !isModalOpen"
      pattern: "useHotkeys.*tab.*setGridFocusIndex"
    - from: "ReviewPage Enter handler"
      to: "selectedVideoId state"
      via: "opens modal for focused card"
      pattern: "useHotkeys.*enter.*setSelectedVideoId"
---

<objective>
Create Server Component page and basic Client orchestrator with Tab/Enter keyboard navigation for grid-to-modal workflow.

Purpose: Establishes foundation for review interface by wiring ReviewGrid, ReviewModal, and ReviewProgress together with basic keyboard navigation. Complex features (optimistic updates, filters, category picker) will be added in Plan 06-05.

Output: 2 new files (Server Component page + basic Client orchestrator with grid/modal integration).
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-review-and-approval-interface/06-CONTEXT.md
@.planning/phases/06-review-and-approval-interface/06-RESEARCH.md
@src/components/ml-review/review-grid.tsx
@src/components/ml-review/review-modal.tsx
@src/components/ml-review/review-progress.tsx
@src/app/actions/ml-categorization.ts
</context>

<tasks>

<task type="auto">
  <name>Create Server Component page for data loading</name>
  <files>
    src/app/ml-review/page.tsx
  </files>
  <action>
Create page.tsx Server Component for /ml-review route:

**Implementation:**
- Import getReviewData, getReviewStats from @/app/actions/ml-categorization
- Import ReviewPage from @/components/ml-review/review-page (client component)
- Fetch initial data: const [results, stats] = await Promise.all([getReviewData('all', 'pending'), getReviewStats()])
- Handle empty state: if results.length === 0, show "No videos to review" message
- Pass results and stats to ReviewPage client component as props
- Add page metadata: export const metadata = { title: 'ML Review - YouTube Playlist Organizer' }

Pattern: Follow Phase 4 src/app/videos/page.tsx pattern - Server Component loads data, Client Component handles interactivity.
  </action>
  <verify>
Check page exports:
```bash
grep -n "export default async function" src/app/ml-review/page.tsx
grep -n "getReviewData" src/app/ml-review/page.tsx
npm run build
```
  </verify>
  <done>
- Server Component page created at /ml-review route
- Fetches initial review data and stats via server actions
- Renders ReviewPage client component with data props
- Handles empty state with message
- TypeScript compilation succeeds
  </done>
</task>

<task type="auto">
  <name>Create basic orchestrator with grid/modal integration and Tab/Enter navigation</name>
  <files>
    src/components/ml-review/review-page.tsx
  </files>
  <action>
Create ReviewPage client component ('use client' directive) with BASIC orchestration - grid/modal integration and Tab/Enter keyboard navigation ONLY:

**Props:** initialResults: ReviewResult[], initialStats: ReviewStats

**State (minimal for this plan):**
- results: ReviewResult[] (simple useState, no optimistic updates yet)
- stats: ReviewStats (simple useState)
- gridFocusIndex: number (for Tab navigation, default 0)
- selectedVideoId: number | null (for modal, default null)

**Computed:**
- isModalOpen: selectedVideoId !== null

**Keyboard navigation (useHotkeys):**
1. **Tab:** Navigate forward through grid
   - useHotkeys('tab', handler, { enabled: !isModalOpen, preventDefault: true })
   - Handler: setGridFocusIndex((prev) => (prev + 1) % results.length)
2. **Shift+Tab:** Navigate backward through grid
   - useHotkeys('shift+tab', handler, { enabled: !isModalOpen, preventDefault: true })
   - Handler: setGridFocusIndex((prev) => (prev - 1 + results.length) % results.length)
3. **Enter:** Open modal for focused card
   - useHotkeys('enter', handler, { enabled: !isModalOpen, preventDefault: true })
   - Handler: setSelectedVideoId(results[gridFocusIndex]?.videoId || null)

**Modal handlers (BASIC for now):**
- onClose: () => setSelectedVideoId(null)
- onNavigate: (newVideoId) => { setSelectedVideoId(newVideoId); update gridFocusIndex to match }
- onAccept: (videoId) => { /* Placeholder - will be implemented in Plan 06-05 */ console.log('Accept:', videoId) }
- onReject: (videoId) => { /* Placeholder - will be implemented in Plan 06-05 */ console.log('Reject:', videoId) }

**Layout:**
- Main container: flex flex-col h-screen
- ReviewProgress at top with stats (no filtering yet - confidenceFilter='all', onFilterChange empty handler)
- ReviewGrid in middle (flex-1) with results, gridFocusIndex, onCardClick, onFocusChange
- ReviewModal with open, selectedVideoId, resultsList, onClose, onNavigate, onAccept (placeholder), onReject (placeholder)
- KeyboardHints overlay at bottom

**NOTE:** This is the BASIC version. Plan 06-05 will add:
- Optimistic updates (useOptimistic hook)
- Real accept/reject handlers with server actions
- Confidence filter functionality
- Review status filtering
- Category picker for recategorization
- Auto-advance logic
- Navbar link

**Imports:** ReviewGrid, ReviewModal, ReviewProgress, KeyboardHints from ml-review components, useHotkeys from react-hotkeys-hook, useState from react, ReviewResult/ReviewStats types from @/types/ml

Pattern: Follow RESEARCH.md Pattern 1 (Grid-to-Modal Navigation State) for keyboard shortcuts with enabled option.
  </action>
  <verify>
Check component structure:
```bash
grep -n "'use client'" src/components/ml-review/review-page.tsx
grep -n "useHotkeys" src/components/ml-review/review-page.tsx
grep -n "gridFocusIndex" src/components/ml-review/review-page.tsx
npm run build
```
  </verify>
  <done>
- ReviewPage orchestrator created with 'use client' directive
- Tab/Shift+Tab/Enter keyboard shortcuts for grid navigation
- Basic grid-to-modal integration (no optimistic updates yet)
- Placeholder accept/reject handlers (console.log only)
- Wires ReviewGrid, ReviewModal, ReviewProgress, KeyboardHints
- TypeScript compilation succeeds
- Ready for Plan 06-05 to add complex features
  </done>
</task>

</tasks>

<verification>
1. Server Component page loads initial data via server actions
2. ReviewPage orchestrates Tab/Enter navigation with conditional shortcuts
3. Modal opens when Enter pressed on focused grid card
4. Modal onNavigate updates both selectedVideoId and gridFocusIndex
5. Accept/reject handlers are placeholders (will be implemented in 06-05)
6. TypeScript compilation succeeds (npm run build)
</verification>

<success_criteria>
- User can navigate to /ml-review route
- Tab/Shift+Tab cycles grid focus with visual focus ring
- Enter opens modal for focused card
- Modal navigation works (Left/Right arrows)
- Escape closes modal
- Grid and modal are properly wired together
- Basic orchestration complete, ready for Plan 06-05 enhancements
</success_criteria>

<output>
After completion, create `.planning/phases/06-review-and-approval-interface/06-04-SUMMARY.md`
</output>
